---
# tasks file for buildrhv
 - name: Authenticate to RHV-M
   ovirt_auth:
     url: "https://{{ rhvm_addr }}/ovirt-engine/api"
     username: "{{ rhv_user }}"
     password: "{{ rhv_pass }}" 
     insecure: true

 - name: create the VM
   ovirt_vms: 
     auth: "{{ ovirt_auth }}"
     state: running
     name: "{{ item }}"
     cluster: "{{ cluster }}"
     wait: True
     template: "{{ template_name }}"
     nics:
       - name: eth0
         profile_name: "{{ network_name }}"
         inferface: virtio 
   with_items: "{{ vm_list }}"

 - name: Tag VM as 'provsioning'
   ovirt_tags:
     auth: "{{ ovirt_auth }}"
     name: provisioning
     state: attached
     vms: 
       - "{{ item }}"
   with_items: "{{ vm_list }}"

 - name: Wait for IP
   pause: 
     seconds: 30
